

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. Introduction &mdash; Monitoring Module for HEC-DSSVue 0.1.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Monitoring Module for HEC-DSSVue 0.1.0 documentation" href="index.html"/>
        <link rel="next" title="2. API Reference" href="reference.html"/>
        <link rel="prev" title="1. Introduction" href="intro.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> Monitoring Module for HEC-DSSVue</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Introduction</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">1. Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#workflow">1.1. Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-toolbox">1.2. Example toolbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fixing-the-hec-dssvue-configuration">1.3. &#8220;Fixing&#8221; the HEC-DSSVue configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">2. API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="reference.html#module-toolbox">2.1. <code class="docutils literal"><span class="pre">toolbox</span></code> &#8212; Toolboxes in HEC-DSSVue</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference.html#module-toolbox.util">2.2. <code class="docutils literal"><span class="pre">toolbox.util</span></code> &#8212; Common utility functions</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Monitoring Module for HEC-DSSVue</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>1. Introduction</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="introduction">
<h1>1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>The HEC-DSS Monitoring Module includes a set of jython scripts that can be used
to rapidly set up &#8220;tools&#8221; to execute various automated tasks in HEC-DSSVue.</p>
<div class="section" id="workflow">
<h2>1.1. Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h2>
<p>The following workflow is assumed:</p>
<blockquote>
<div><ol class="arabic simple">
<li>A <cite>yaml</cite> configuration file defines the tool&#8217;s input parameters. The
configuration file is saved alongside the HEC-DSS <cite>.dss</cite> file.</li>
<li>The <a class="reference internal" href="reference.html#toolbox.Tool" title="toolbox.Tool"><code class="xref py py-class docutils literal"><span class="pre">toolbox.Tool</span></code></a> is sub-classed to define the tool. The method
<a class="reference internal" href="reference.html#toolbox.Tool.main" title="toolbox.Tool.main"><code class="xref py py-meth docutils literal"><span class="pre">toolbox.Tool.main()</span></code></a> includes the task logic (e.g. importing data,
creating plots, etc.).</li>
<li>The tool is run using the <a class="reference internal" href="reference.html#toolbox.Tool.run" title="toolbox.Tool.run"><code class="xref py py-meth docutils literal"><span class="pre">toolbox.Tool.run()</span></code></a> method.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="example-toolbox">
<h2>1.2. Example toolbox<a class="headerlink" href="#example-toolbox" title="Permalink to this headline">¶</a></h2>
<p>Example of a HEC-DSS script using the <a class="reference internal" href="reference.html#toolbox.Tool" title="toolbox.Tool"><code class="xref py py-class docutils literal"><span class="pre">toolbox.Tool</span></code></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># name=Example tool</span>
<span class="c"># displayinmenu=true</span>
<span class="c"># displaytouser=true</span>
<span class="c"># displayinselector=true</span>

<span class="kn">import</span> <span class="nn">toolbox</span>
<span class="kn">from</span> <span class="nn">some_module</span> <span class="kn">import</span> <span class="n">do_something</span>

<span class="n">CONFIG_FILE</span> <span class="o">=</span> <span class="s">&#39;input.yml&#39;</span>  <span class="c"># Relative to DSS-file</span>

<span class="k">class</span> <span class="nc">ExampleTool</span><span class="p">(</span><span class="n">toolbox</span><span class="o">.</span><span class="n">Tool</span><span class="p">):</span>
    <span class="n">requiredParams</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;folder&#39;</span><span class="p">,</span> <span class="s">&#39;files&#39;</span><span class="p">,</span> <span class="s">&#39;site&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
    <span class="n">refreshCatalogue</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c"># Update catalogue when completed</span>

    <span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">do_something</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dssFilePath</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s">&quot;Test tool successfully completed.&quot;</span>

<span class="n">tool</span> <span class="o">=</span> <span class="n">ExampleTool</span><span class="p">(</span><span class="n">CONFIG_FILE</span><span class="p">)</span>
<span class="n">tool</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>The above code should be saved in a file like this
<code class="file docutils literal"><span class="pre">%APPDATA%/Roaming/HEC/HEC-DSSVue/scripts/example_tool.py</span></code> for it to show
up in the HEC-DSSVue <span class="menuselection">Script</span> menu and toolbar.</p>
<p>The corresponding configuration file <code class="file docutils literal"><span class="pre">input.yml</span></code> could look like this.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">folder</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">C:\some\folder</span>
<span class="l-Scalar-Plain">files</span><span class="p-Indicator">:</span>
 <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">file 1.txt</span>
 <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">file 2.txt</span>

<span class="l-Scalar-Plain">site</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Site name</span>
<span class="nn">...</span>
</pre></div>
</div>
</div>
<div class="section" id="fixing-the-hec-dssvue-configuration">
<h2>1.3. &#8220;Fixing&#8221; the HEC-DSSVue configuration<a class="headerlink" href="#fixing-the-hec-dssvue-configuration" title="Permalink to this headline">¶</a></h2>
<p>All scripts are executed within the HEC-DSSVue application (Java-based) using an
embedded Python interpreter, Jython 2.2. This version of Jython was released in
2007 and does not have the same functionality as recent releases of Python 2.7
and 3.x.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The most recent yaml parsers available for Python do not work with Jython
2.2. An archived version of a <a class="reference external" href="http://pyyaml.org/wiki/PyYAMLLegacy">legacy yaml parser</a> has therefore been included in the
HEC-DSS Monitoring Module. This parser does unfortunately not support the
full yaml spec!</p>
</div>
<div class="section" id="python-search-path">
<h3>1.3.1. Python search path<a class="headerlink" href="#python-search-path" title="Permalink to this headline">¶</a></h3>
<p>HEC-DSSVue scripts are saved in the
<code class="file docutils literal"><span class="pre">%APPDATA%/Roaming/HEC/HEC-DSSVue/scripts</span></code> folder. Scripts in this folder
can be run directly from HEC-DSSVue window.</p>
<p>The scripts folder is not available on the Python search path by default and
this prevents any imports to Python modules in the same folder. The only way to
fix this is by modifying the <code class="docutils literal"><span class="pre">vmparam</span> <span class="pre">-Dpython.path</span></code> variable in the file
<code class="file docutils literal"><span class="pre">%programfiles(x86)%/HEC/HEC-DSSVue/HEC-DSSVue.config</span></code> like this:</p>
<div class="highlight-python"><div class="highlight"><pre>vmparam -Dpython.path=jar\sys\jythonLib.jar\lib;jar\sys\jythonUtils.jar;$APPDATA\HEC\HEC-DSSVue\scripts
</pre></div>
</div>
</div>
<div class="section" id="jython-configuration">
<h3>1.3.2. Jython configuration<a class="headerlink" href="#jython-configuration" title="Permalink to this headline">¶</a></h3>
<p>On Windows operating systems released since 2009, Jython 2.2 throws an error as
it assumes the operating system being Linux. To fix this, add the file
<code class="file docutils literal"><span class="pre">%HOME%/.jython</span></code> with the following content:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">python</span><span class="o">.</span><span class="n">os</span><span class="o">=</span><span class="n">nt</span>
</pre></div>
</div>
</div>
<div class="section" id="debugging-in-hec-dssvue">
<h3>1.3.3. Debugging in HEC-DSSVue<a class="headerlink" href="#debugging-in-hec-dssvue" title="Permalink to this headline">¶</a></h3>
<p>To make debugging scripts in HEC-DSSVue easier, the Java console window can be
shown when starting HEC-DSSVue by setting <code class="docutils literal"><span class="pre">showConsole</span> <span class="pre">true</span></code> in the
<code class="file docutils literal"><span class="pre">HEC-DSSVue.config</span></code> file. Java and Jython errors will be displayed in this
window.</p>
<p>Alternatively the console output can be inspected from the HEC-DSSVue menu
<span class="menuselection">Advanced ‣ Console Output...</span>.</p>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="reference.html" class="btn btn-neutral float-right" title="2. API Reference">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="intro.html" class="btn btn-neutral" title="1. Introduction"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, EnviroCentre.
      Last updated on 23/04/2015.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>